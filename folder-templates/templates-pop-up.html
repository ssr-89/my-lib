<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Pop-up - модальное окно</title>
	<link rel="shortcut icon" href="img/favicon-main.png" type="image/x-icon">
	<link rel="stylesheet" href="../css/style.css">
	<link rel="stylesheet" href="../css/accordion.css">
	<link rel="stylesheet" href="css/templates-main.css">
	<link rel="stylesheet" href="css/templates-pop-up.css">
	<script defer src="../js/script.js"></script>
	<script defer src="../js/accordion.js"></script>
  <script defer src="../js/tabs.js"></script>
	<script defer src="js/templates-main.js"></script>
	<script defer src="js/templates-pop-up.js"></script>
</head>
<body>
	<div class="wrapper">
    <section id="popup-link" class="popup-section">
      <div class="popup-link__container">
        <a href="#popup" class="click popup-link lock-padding">Pop-up #1</a>
      </div>
    </section>
    <div id="popup" class="popup">
      <div class="popup__body">
        <div class="popup__content">
          <a class="popup__close link close-popup" href="#">&#10006;</a>
          <div class="popup__title">Это модальное окно №1</div>
          <div class="popup__text">
            <a id="popup-2" href="#popup__2" class="click popup-link">Pop-up #2</a> Далеко-далеко за словесными горами, в стране гласных и согласных живут рыбные тексты. Буквенных встретил лучше, lorem что пунктуация запятой коварных несколько, продолжил оксмокс которой выйти правилами по всей эта страна вопрос о. Переулка?
          </div>
        </div>
      </div>
    </div>
    <div id="popup__2" class="popup">
      <div class="popup__body">
        <div class="popup__content">
          <a class="popup__close link close-popup" href="#">&#10006;</a>
          <div class="popup__title">Это модальное окно №2</div>
          <div class="popup__text">
            <a id="popup-3" href="#popup__3" class="click popup-link">Pop-up #3</a> Далеко-далеко за словесными горами, в стране гласных и согласных живут рыбные тексты. Буквенных встретил лучше, lorem что пунктуация запятой коварных несколько, продолжил оксмокс которой выйти правилами по всей эта страна вопрос о. Переулка?
          </div>
        </div>
      </div>
    </div>
    <div id="popup__3" class="popup">
      <div class="popup__body">
        <div class="popup__content">
          <a class="popup__close link close-popup" href="#">&#10006;</a>
          <div class="popup__title">Это модальное окно №3</div>
          <div class="popup__text">
            <a id="popup-1" href="#popup" class="click popup-link">Pop-up #1</a> Далеко-далеко за словесными горами, в стране гласных и согласных живут рыбные тексты. Буквенных встретил лучше, lorem что пунктуация запятой коварных несколько, продолжил оксмокс которой выйти правилами по всей эта страна вопрос о. Переулка?
          </div>
        </div>
      </div>
    </div>
    <section id="code-pop-up" class="code-pop-up" style="padding: 100px 50px 50px;">
      <div class="code-pop-up__container">
        <div class="code-pop-up__top code-pop-up-top">
          <h2 class="code-pop-up-top__title title">!!!ВАЖНО!!!</h2>
          <p class="code-pop-up-top__text text">
            Для фиксированных объектов необходимо добавить класс lock-padding
          </p>
        </div>
        <div class="code-pop-up__content code-pop-up-content">
          <div class="code-pop-up-content__btns code-pop-up-btns">
            <button class="code-pop-up-btn btn tabs-btn open-tabs-btn" data-path="pop-up-html">HTML</button>
            <button class="code-pop-up-btn btn tabs-btn" data-path="pop-up-css">CSS</button>
            <button class="code-pop-up-btn btn tabs-btn" data-path="pop-up-js">JS</button>
          </div>
          <div class="code-pop-up-content__items code-pop-up-items">
            <div data-target="pop-up-html" class="code-pop-up-items__item code-pop-up-item tabs-item open-tabs-item">
              <pre class="code-pop-up-item__pre">
&lt;div class="wrapper"&gt;
  &lt;header id="header" class="header lock-padding"&gt;
    &lt;div class="header__container"&gt;
      &lt;a href="#popup" class="click popup-link"&gt;Pop-up #1&lt;/a&gt;
    &lt;/div&gt;
  &lt;/header&gt;
  &lt;div id="popup" class="popup"&gt;
    &lt;div class="popup__body"&gt;
      &lt;div class="popup__content"&gt;
        &lt;a class="popup__close link close-popup" href="#"&gt;&#10006;&lt;/a&gt;
        &lt;div class="popup__title"&gt;Это модальное окно №1&lt;/div&gt;
        &lt;div class="popup__text"&gt;
          &lt;a href="#popup__2" class="click popup-link"&gt;Pop-up #2&lt;/a&gt;
          Далеко-далеко за словесными горами, в стране гласных и согласных живут рыбные тексты.
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div id="popup__2" class="popup"&gt;
    &lt;div class="popup__body"&gt;
      &lt;div class="popup__content"&gt;
        &lt;a class="popup__close link close-popup" href="#"&gt;&#10006;&lt;/a&gt;
        &lt;div class="popup__title"&gt;Это модальное окно №2&lt;/div&gt;
        &lt;div class="popup__text"&gt;
          &lt;a href="#popup__3" class="click popup-link"&gt;Pop-up #3&lt;/a&gt;
          Далеко-далеко за словесными горами, в стране гласных и согласных живут рыбные тексты.
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div id="popup__3" class="popup"&gt;
    &lt;div class="popup__body"&gt;
      &lt;div class="popup__content"&gt;
        &lt;a class="popup__close link close-popup" href="#"&gt;&#10006;&lt;/a&gt;
        &lt;div class="popup__title"&gt;Это модальное окно №3&lt;/div&gt;
        &lt;div class="popup__text"&gt;
          &lt;a href="#popup" class="click popup-link"&gt;Pop-up #1&lt;/a&gt;
          Далеко-далеко за словесными горами, в стране гласных и согласных живут, рыбные тексты.
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
              </pre>
            </div>
            <div data-target="pop-up-css" class="code-pop-up-items__item code-pop-up-item tabs-item">
              <pre class="code-pop-up-item__pre">
*,
*::before,
*::after {
  box-sizing: border-box;
}
body.lock {
  overflow: hidden;
}
.link {
  text-decoration: none;
  color: inherit;
}
#header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 50px;
  background-color: #fff;
}

.popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  z-index: 3;
  font-family: Arial, Impact, Haettenschweiler, "Arial Narrow Bold", sans-serif;
  opacity: 0;
  visibility: hidden;
  overflow-y: auto;
  overflow-x: hidden;
  transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
}
.popup.open {
  opacity: 1;
  visibility: visible;
}
.popup.open .popup__content {
  transform: perspective(600px) translate(0, 0) rotatex(0deg);
}
.popup__area {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  cursor: default;
}
.popup__body {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 30px 10px;
  min-height: 100%;
}
.popup__content {
  position: relative;
  padding: 30px;
  background-color: #fff;
  color: #000;
  max-width: 800px;
  transform: perspective(600px) translate(0, -100%) rotatex(45deg);
  transition: transform 0.3s ease-in-out;
}
.popup__close {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 2em;
}
.popup__title {
  font-size: 40px;
  margin-bottom: 1em;
}
.popup__text {
}
              </pre>
            </div>
            <div data-target="pop-up-js" class="code-pop-up-items__item code-pop-up-item tabs-item">
              <pre class="code-pop-up-item__pre">
const popupLinks = document.querySelectorAll(".popup-link");
const body = document.querySelector("body");
const lockPadding = document.querySelectorAll(".lock-padding");

let unlock = true;

const timeout = 300;

if (popupLinks.length > 0) {
  for (let index = 0; index < popupLinks.length; index++) {
    const popupLink = popupLinks[index];
    popupLink.addEventListener("click", function (e) {
      const popupName = popupLink.getAttribute("href").replace("#", ""); <i class="color-yellow">// replace убирает значок #</i>
      const currentPopup = document.getElementById(popupName); <i class="color-yellow">// ищет по значению popupName совпадение с id</i>
      popupOpen(currentPopup);
      e.preventDefault(); <i class="color-yellow">// использовать для ссылок</i>
    });
  }
}

const popupCloseIcon = document.querySelectorAll(".close-popup");
if (popupCloseIcon.length > 0) {
  for (let index = 0; index < popupCloseIcon.length; index++) {
    const el = popupCloseIcon[index];
    el.addEventListener("click", function (e) {
      popupClose(el.closest(".popup")); <i class="color-yellow">// отправляет объект в функцию popupClose(), </i>
      <i class="color-yellow">// который является для кнопки закрытия ближайшим родителем с классом popup. </i>
      <i class="color-yellow">// Т.е., плсде нажатия кнопки-закрытия будет искать ближайшего родителя с классом popup и закроет его с помощью функции popupClose().</i>
      e.preventDefault();
    });
  }
}

function popupOpen(currentPopup) {
  if (currentPopup && unlock) {
    const popupActive = document.querySelector(".popup.open");
    if (popupActive) {
      popupClose(popupActive, false);
    } else {
      bodyLock();
    }
    currentPopup.classList.add("open");
    currentPopup.addEventListener("click", function (e) {
      if (!e.target.closest(".popup__content")) {
        <i class="color-yellow">// если у нажатого объекта нет родителя с классом popup__content</i>
        popupClose(e.target.closest(".popup")); <i class="color-yellow">// передаём объект в функцию, у которого родитель ближайший с классом popup</i>
      }
    });
  }
}
function popupClose(popupActive, doUnlock = true) {
  if (unlock) {
    popupActive.classList.remove("open"); <i class="color-yellow">// активный попап закрывается</i>
    if (doUnlock) {
      <i class="color-yellow">// если doUnlock = true, то запрещаем выполнять bodyUnLock(). Т.е, при нажатии на попап при открытом попап не будет повторно блокироваться скролл.</i>
      bodyUnLock();
    }
  }
}

function bodyLock() {
  const lockPaddingValue =
    window.innerWidth - document.querySelector(".wrapper").offsetWidth + "px"; <i class="color-yellow">// разница между шириной всего viewport и шириной объекта, который находится внутри viewport. </i>
    <i class="color-yellow">// Т.е., получаем ширину скролла, который убирается при открытии popup. </i>
    <i class="color-yellow">// Это делается для того, чтобы при исчезновании/появлении скролла контент не двигался в стороны на ширину скролла.</i>
  

  /*проверка наличие объектов lockPadding*/
  if (lockPadding.length > 0) {
    <i class="color-yellow">/*цикл для фиксированных объектов, чтобы не двигались при исчезновании/появлении скролла*/</i>
    for (let index = 0; index < lockPadding.length; index++) {
      const el = lockPadding[index];
      el.style.paddingRight = lockPaddingValue;
    }
  }
  body.style.paddingRight = lockPaddingValue;
  body.classList.add("lock");

  unlock = false;
  <i class="color-yellow">/*таймаут используется для того, что дополнительно не заблокировался скролл при новом нажатии на ссылку popup после закрытия предыдущего*/</i>
  setTimeout(function () {
    unlock = true;
  }, timeout);
}

<i class="color-yellow">/*появление скролла с таймаутом, чтобы не сдвигался попап-контент при закрытии*/</i>
function bodyUnLock() {
  setTimeout(function () {
    /*проверка наличие объектов lockPadding*/
    if (lockPadding.length > 0) {
      for (let index = 0; index < lockPadding.length; index++) {
        const el = lockPadding[index];
        el.style.paddingRight = "0px";
      }
    }
    body.style.paddingRight = "0px";
    body.classList.remove("lock");
  }, timeout);

  unlock = false;
  setTimeout(function () {
    unlock = true;
  }, timeout);
}

document.addEventListener("keydown", function (e) {
  if (e.which === 27) {
    <i class="color-yellow">// код клавиши 27 (Esc)</i>
    const popupActive = document.querySelector(".popup.open");
    popupClose(popupActive);
  }
});
              </pre>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</body>
</html>